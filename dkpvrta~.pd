#N canvas 386 244 886 644 12;
#X obj 225 151 rfft~;
#X obj 223 194 pdkfft/dkcarpol~;
#X obj 346 228 -~;
#X obj 224 268 pdkfft/dkpolcar~;
#N canvas 922 549 450 300 lock 0;
#X obj 53 32 inlet~;
#X obj 54 185 +~;
#X obj 118 157 *~ 0;
#X obj 104 102 lrshift~ 1;
#X obj 206 98 lrshift~ -1;
#X obj 312 35 inlet lock;
#X obj 54 210 outlet~;
#X connect 0 0 1 0;
#X connect 0 0 3 0;
#X connect 0 0 4 0;
#X connect 1 0 6 0;
#X connect 2 0 1 1;
#X connect 3 0 2 0;
#X connect 4 0 2 0;
#X connect 5 0 2 1;
#X restore 222 325 pd lock;
#N canvas 922 549 450 300 lock 0;
#X obj 53 32 inlet~;
#X obj 54 185 +~;
#X obj 118 157 *~ 0;
#X obj 104 102 lrshift~ 1;
#X obj 206 98 lrshift~ -1;
#X obj 312 35 inlet lock;
#X obj 54 210 outlet~;
#X connect 0 0 1 0;
#X connect 0 0 3 0;
#X connect 0 0 4 0;
#X connect 1 0 6 0;
#X connect 2 0 1 1;
#X connect 3 0 2 0;
#X connect 4 0 2 0;
#X connect 5 0 2 1;
#X restore 349 302 pd lock;
#X obj 223 358 pdkfft/dkcarpol~;
#X obj 138 378 rfft~;
#X text 254 108 back window;
#X text 379 362 backwin - prevphs;
#X obj 328 432 -~;
#X text 365 428 frontwin - backwin + prevphs;
#X obj 204 478 pdkfft/dkpolcar~;
#X obj 203 537 rifft~;
#X text 465 73 copied from I07.phase.vocoder but a little cleaner;
#N canvas 455 309 908 740 bufreader 0;
#X obj 180 33 r \$0-winsize;
#X obj 238 146 * 1;
#X obj 381 32 t b f;
#X msg 381 57 2;
#X obj 381 82 pow;
#X obj 428 64 / 12;
#X obj 380 110 clip 0.125 8;
#X obj 381 166 t b f;
#X text 448 35 window stretch amt;
#X obj 255 82 samplerate~;
#X obj 188 84 * 1000;
#X obj 188 109 /;
#X text 238 103 windowsize in ms;
#X text 100 518 front window;
#X text 430 480 backwindow;
#X obj 50 393 line~;
#X obj 648 369 inlet~;
#X obj 30 513 *~;
#X obj 271 513 *~;
#X obj 30 538 outlet~;
#X obj 271 538 outlet~;
#X obj 381 7 inlet transpose;
#X obj 188 59 t f b;
#X obj 239 292 / 4;
#X obj 380 135 - 1;
#X text 505 79 no pitch shift = 0 ms delay;
#X obj 57 90 bang~;
#X text 206 2 win size in samps;
#X text 347 192 stretched windowsize in ms;
#X obj 104 154 t b f;
#X obj 104 204 -;
#X text 685 12 init delay = 100 ms;
#X text 15 17 sub from init delay;
#X text 5 45 pitch inc = delay dec;
#X obj 57 208 f;
#X obj 57 233 / 4;
#X obj 187 175 / 4;
#X obj 115 236 / 4;
#X obj 55 267 pack f f;
#X text 192 225 compensate for 4x overlap (4 windows/block);
#X text 198 254 ms needs additional compensation factor;
#X obj 55 292 t l b;
#X obj 106 347 / 4;
#X obj 209 423 +~ 0;
#X text 298 316 backwindow 1/4 cycle behind (more delay);
#X obj 239 317 / 4;
#X obj 30 472 delread4~ \$0-ipt;
#X text 464 544 copied from Roman Haefeli's fft-pitchshifter;
#X floatatom 20 253 5 0 0 0 - - -, f 5;
#X msg 104 179 100;
#X msg 104 319 100;
#X obj 269 480 delread4~ \$0-ipt;
#X connect 0 0 22 0;
#X connect 1 0 23 0;
#X connect 1 0 29 0;
#X connect 2 0 3 0;
#X connect 2 1 5 0;
#X connect 3 0 4 0;
#X connect 4 0 6 0;
#X connect 5 0 4 1;
#X connect 6 0 24 0;
#X connect 7 0 1 0;
#X connect 7 1 1 1;
#X connect 9 0 11 1;
#X connect 10 0 11 0;
#X connect 11 0 1 0;
#X connect 11 0 36 0;
#X connect 15 0 43 0;
#X connect 15 0 46 0;
#X connect 16 0 17 1;
#X connect 16 0 18 1;
#X connect 17 0 19 0;
#X connect 18 0 20 0;
#X connect 21 0 2 0;
#X connect 22 0 10 0;
#X connect 22 1 9 0;
#X connect 23 0 45 0;
#X connect 24 0 7 0;
#X connect 26 0 34 0;
#X connect 29 0 49 0;
#X connect 29 1 30 1;
#X connect 30 0 34 1;
#X connect 34 0 35 0;
#X connect 34 0 48 0;
#X connect 35 0 38 0;
#X connect 36 0 37 0;
#X connect 37 0 38 1;
#X connect 38 0 41 0;
#X connect 41 0 15 0;
#X connect 41 1 50 0;
#X connect 42 0 15 0;
#X connect 43 0 51 0;
#X connect 45 0 43 1;
#X connect 46 0 17 0;
#X connect 49 0 30 0;
#X connect 50 0 42 0;
#X connect 51 0 18 0;
#X restore 141 106 pd bufreader;
#X obj 612 178 loadbang;
#X text 663 214 windodwsize;
#X obj 612 239 moses 9;
#X msg 612 264 9;
#X obj 612 289 dkp2rnd;
#X obj 669 326 s \$0-winsize;
#X text 412 142 needs dkp2rnd \, dkwinbl~ \, dkcarpol~ dkpolcar~ from
pdkfft;
#X obj 617 463 block~ 1024 4;
#X obj 469 51 pdkfft/dkwinbl~ hann;
#X obj 203 562 *~;
#X obj 157 8 inlet transpose;
#X msg 617 429 set \$1 4;
#X obj 327 512 r \$0-winsize;
#X obj 327 537 t b f;
#X msg 327 562 2;
#X obj 327 587 /;
#X obj 378 565 * 3;
#X text 412 538 normalization;
#X obj 202 587 *~ 1;
#X obj 202 612 outlet~;
#X obj 670 403 array define \$0-prevphs;
#X obj 378 190 tabreceive~ \$0-prevphs;
#X obj 667 374 array size \$0-prevphs;
#X text 573 600 in2 - tranposition in halfsteps;
#X text 733 38 Derek Kwan 2016;
#X obj 382 478 tabsend~ \$0-prevphs;
#X obj 377 32 bang;
#X obj 371 68 s \$0-reset;
#X obj 30 224 r \$0-reset;
#X obj 30 249 f \$0;
#X obj 376 7 inlet reset;
#X msg 30 274 \; \$1-prevphs const 0;
#X text 574 583 in1~ - sig input;
#X obj 294 6 loadbang;
#X obj 7 9 inlet~ ipt;
#X obj 8 46 delwrite~ \$0-ipt 1000;
#X text 574 6 dkpvrta~ - phase vocoder (real-time);
#X text 590 94 (does cartesian-polar conversions);
#X text 410 120 reading bits taken from Roman Haefeli's fft-pitchshifter
;
#X obj 215 63 f \$2;
#X obj 613 215 f \$1;
#X text 589 483 arg1 - fft size;
#X text 586 499 arg2 - transposition amt in hs;
#X connect 0 0 1 0;
#X connect 0 1 1 1;
#X connect 1 0 3 0;
#X connect 1 1 2 0;
#X connect 2 0 3 1;
#X connect 3 0 4 0;
#X connect 3 1 5 0;
#X connect 4 0 6 0;
#X connect 5 0 6 1;
#X connect 6 1 10 1;
#X connect 7 0 12 0;
#X connect 7 1 10 0;
#X connect 10 0 12 1;
#X connect 10 0 41 0;
#X connect 12 0 13 0;
#X connect 12 1 13 1;
#X connect 13 0 25 0;
#X connect 15 0 7 0;
#X connect 15 1 0 0;
#X connect 16 0 56 0;
#X connect 18 0 19 0;
#X connect 18 1 20 0;
#X connect 19 0 20 0;
#X connect 20 0 21 0;
#X connect 20 0 27 0;
#X connect 20 0 38 0;
#X connect 24 0 15 1;
#X connect 24 0 25 1;
#X connect 25 0 34 0;
#X connect 26 0 55 0;
#X connect 27 0 23 0;
#X connect 28 0 29 0;
#X connect 29 0 30 0;
#X connect 29 1 32 0;
#X connect 30 0 31 0;
#X connect 31 0 34 1;
#X connect 32 0 31 1;
#X connect 34 0 35 0;
#X connect 37 0 2 1;
#X connect 42 0 43 0;
#X connect 44 0 45 0;
#X connect 45 0 47 0;
#X connect 46 0 42 0;
#X connect 49 0 55 0;
#X connect 50 0 51 0;
#X connect 55 0 15 0;
#X connect 56 0 18 0;
